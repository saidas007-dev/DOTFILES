-- HELPER: LOAD PYWAL COLORS AUTOMATICALLY
function conky_load_pywal_colors()
    local handle = io.popen("sed -n '1p;2p;3p;4p;5p;6p' ~/.cache/wal/colors")
    local colors = {}
    for line in handle:lines() do
        table.insert(colors, line)
    end
    handle:close()
    return colors
end

local p = conky_load_pywal_colors()

conky.config = {
    -- Window Settings
    own_window = true,
    own_window_class = 'Conky',
    own_window_type = 'normal',
    own_window_hints = 'undecorated,below,sticky,skip_taskbar,skip_pager',
    own_window_transparent = true,
    own_window_argb_visual = true,
    own_window_argb_value = 255,

    -- Layout (Card Style)
    alignment = 'middle_right',
    gap_x = 50,
    gap_y = 0,
    minimum_width = 420,
    maximum_width = 420,
    border_inner_margin = 30,
    border_outer_margin = 10,

    -- Font Settings
    font = 'Maple Mono NF:style=Bold:size=12',
    use_xft = true,
    xftalpha = 1,
    uppercase = false,
    override_utf8_locale = true,
    
    -- Colors
    default_color = 'white',
    color0 = p[1], -- Background
    color1 = p[2], -- Accent 1 (Primary - Titles & Labels)
    color2 = p[3], -- Accent 2 (Secondary - Unused in text now, kept for reference)
    color3 = p[5], -- Muted (Bars/Graphs)
    
    -- Graphics
    draw_shades = true,
    default_shade_color = '#000000',
    draw_graph_borders = true,
    show_graph_scale = false,
    
    -- Refresh
    update_interval = 1.00,
    double_buffer = true,
    no_buffers = true,
}

conky.text = [[

${color1}${font Maple Mono NF:style=Bold:size=15}  SYSTEM ${hr 2}${font}${color}
${voffset 12}
${offset 5}${color1}Host:${alignr}${color}${nodename}
${offset 5}${color1}Kernel:${alignr}${color}${kernel}
${offset 5}${color1}Uptime:${alignr}${color}${uptime}

${color1}${font Maple Mono NF:style=Bold:size=15}  RESOURCES ${hr 2}${font}${color}
${voffset 12}
${offset 5}${color1}CPU Frequency:${alignr}${color}${freq_g} GHz
${offset 5}${color1}CPU Usage:${alignr}${color}${cpu}%
${offset 5}${color3}${cpubar 15}${color}
${voffset 12}
${offset 5}${color1}RAM Usage:${alignr}${color}${mem} / ${memmax}
${offset 5}${color3}${membar 15}${color}

${color1}${font Maple Mono NF:style=Bold:size=15}  STORAGE ${hr 2}${font}${color}
${voffset 12}
${offset 5}${color1}Home (/home):${alignr}${color}${fs_used /home} / ${fs_size /home}
${offset 5}${color3}${fs_bar 15 /home}${color}

${color1}${font Maple Mono NF:style=Bold:size=15}  NETWORK ${hr 2}${font}${color}
${voffset 12}
${offset 5}${color1}IP Address:${alignr}${color}${addr wlo1}
${offset 5}${color1}Down:${alignr}${color}${downspeed wlo1}
${offset 5}${color3}${downspeedgraph wlo1 50,0}${color}
${offset 5}${color1}Up:${alignr}${color}${upspeed wlo1}
${offset 5}${color3}${upspeedgraph wlo1 50,0}${color}

${color1}${font Maple Mono NF:style=Bold:size=15}  TOP PROCESSES ${hr 2}${font}${color}
${voffset 12}
${offset 5}${color1}Name${alignr}CPU%   MEM%${color}
${offset 5}${top name 1 18}${alignr}${top cpu 1}%   ${top mem 1}%
${offset 5}${top name 2 18}${alignr}${top cpu 2}%   ${top mem 2}%
${offset 5}${top name 3 18}${alignr}${top cpu 3}%   ${top mem 3}%
${offset 5}${top name 4 18}${alignr}${top cpu 4}%   ${top mem 4}%
${offset 5}${top name 5 18}${alignr}${top cpu 5}%   ${top mem 5}%
]]
