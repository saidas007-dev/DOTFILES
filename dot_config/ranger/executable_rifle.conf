# ~/.config/ranger/rifle.conf
# Customized for Linux Mint Cinnamon preferences
# Priority: GUI apps -> terminal fallbacks -> xdg-open

# ---------------------------
# Text / Code files
# ---------------------------
# Plain text: open in xed (default Cinnamon text viewer)
mime ^text, !ext py|pl|rb|js|sh|php|c|cpp|h|java|lua|go|rs = xed "$@"

# Code & scripts: open in neovim
ext py|pl|rb|js|sh|php|c|cpp|h|java|lua|go|rs = nvim "$@"

# Makefiles
name ^[mM]akefile$ = nvim "$1"

# ---------------------------
# Scripts (run)
# ---------------------------
ext py  = python3 -- "$1"
ext pl  = perl -- "$1"
ext rb  = ruby -- "$1"
ext js  = node -- "$1"
ext sh  = bash -- "$1"
ext php = php -- "$1"

# ---------------------------
# Video / Audio
# ---------------------------
# Video -> VLC
mime ^video, has vlc, X, flag f = vlc -- "$@"

# Audio -> Spotify
mime ^audio, has spotify, X, flag f = spotify --uri "$@"

# Fallbacks
mime ^video|audio, has xdg-open, X = xdg-open -- "$@"

# ---------------------------
# PDFs / Documents
# ---------------------------

# ✅ FIXED: Ensure Okular always opens PDFs
ext pdf, has okular, X, flag f = okular -- "$@"
mime application/pdf, has okular, X, flag f = okular -- "$@"

# Office docs → OnlyOffice
ext docx|pptx|xlsx, has onlyoffice-desktopeditors, X, flag f = onlyoffice-desktopeditors "$@"

# Foliate for EPUB
ext epub, has foliate, X, flag f = foliate "$1"
mime application/epub+zip, has foliate, X, flag f = foliate "$1"

# ---------------------------
# Images (use Mint's default viewer: Pix)
# ---------------------------
mime ^image, has pix, X, flag f = pix -- "$@"
mime ^image, has xdg-open, X = xdg-open -- "$@"

# ---------------------------
# Archives
# ---------------------------
ext 7z, has 7z = 7z x -y "$@"
ext zip, has unzip = for file in "$@"; do unzip -d "${file%.*}" "$file"; done
ext rar, has unrar = for file in "$@"; do unrar x "$file"; done
ext tar|tgz|tar.gz|tar.xz, has tar = for file in "$@"; do tar xvpf "$file"; done

# ---------------------------
# Default openers
# ---------------------------
label open, has xdg-open = xdg-open -- "$@"
label trash, has trash-put = trash-put -- "$@"

# Fallback (ask user)
!mime ^text = ask

